---
title: 通俗的理解三次握手
date: 2017-11-20 10:46:47
tags: TCP
categories: 后端
---
***【来源网上的说法，具体出处未知】*** TCP“三次握手” 这个问题的本质是, 信道不可靠, 但是通信双发需要就某个问题达成一致. 而要解决这个问题, 无论你在消息中包含什么信息, **三次通信是理论上的最小值. 所以三次握手不是TCP本身的要求,** 而是为了满足"**在不可靠信道上可靠地传输信息**"这一需求所导致的. 请注意这里的本质需求,信道不可靠, 数据传输要可靠. 三次达到了, 那后面你想接着握手也好, 发数据也好, 跟进行可靠信息传输的需求就没关系了. 因此,**如果信道是可靠的, 即无论什么时候发出消息, 对方一定能收到, 或者你不关心是否要保证对方收到你的消息, 那就能像UDP那样直接发送消息就可以了.**”。这可视为对“三次握手”目的的另一种解答思路。

>后面一段话意思就是如果想确定双通道通畅，必须使用三个包的发送接收，也就是三次握手

>这段话指出了为什么要三次握手，【就是要 解决<font color="#b74040">***在不可靠信道上可靠的传输信息***</font>】


## 一、通俗解释
三次握手流程的本质，可以这么理解：TCP的三次握手其实是双方各一次握手，各一次确认，只是其中一次握手和确认合并在一起。

当然也可以更通俗的去理解：

“喂，你听得到吗？”
“我听得到呀，你听得到我吗？”
“我能听到你”


## 二、三次握手流程图

![](https://ws3.sinaimg.cn/large/006tKfTcly1floczymys9j30fm0bdaan.jpg)


## 三、简单说下SYN攻击
在三次握手过程中，Server发送SYN-ACK之后，收到Client的ACK之前的TCP连接称为半连接（half-open connect），此时Server处于SYN_RCVD状态，当收到ACK后，Server转入ESTABLISHED状态。SYN攻击就是Client在短时间内伪造大量不存在的IP地址，并向Server不断地发送SYN包，Server回复确认包，并等待Client的确认，由于源地址是不存在的，因此，Server需要不断重发直至超时，这些伪造的SYN包将产时间占用未连接队列，导致正常的SYN请求因为队列满而被丢弃，从而引起网络堵塞甚至系统瘫痪。SYN攻击时一种典型的DDOS攻击，检测SYN攻击的方式非常简单，即当Server上有大量半连接状态且源IP地址是随机的，则可以断定遭到SYN攻击了

>整理一下：
1. SYN 攻击是一种 典型的 DDOS 攻击
2. SYN 攻击发生在三次握手的第二次（Server回复 大量伪造Client 的确定包，超时导致）
3. Server 上有大量半连接状态且 IP 地址是随机的，可以断定遇到 SYN 攻击


## 四、来源文章
[《通俗理解TCP的三次握手》](http://mp.weixin.qq.com/s/B2ZRYbLIGlqsOBMjy5PY3g)